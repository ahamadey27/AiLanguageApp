@page
@model AiLanguageApp.Pages.GeneratorModel
@{
    ViewData["Title"] = "AI Language Generator";
}

<h2>AI Language Generator</h2>

<!-- Display the message from PageModel -->
@if (!string.IsNullOrEmpty(Model.Message))
{
    <p class="alert alert-info">@Model.Message</p>
}

<form method="post">
    <div>
        <label for="generatorInputText">Enter text to generate language:</label><br />
        <textarea id="generatorInputText" name="GeneratorInputText" asp-for="GeneratorInputText" rows="4" cols="50">@Model.GeneratorInputText</textarea><br />
        <span asp-validation-for="GeneratorInputText" class="text-danger"></span> <!-- ADD THIS LINE -->
    </div>
    <div>
        <button type="submit">Generate & Play Sound</button>
    </div>
    <div style="margin-top: 10px;">
        <label>Generated Sound Code (Optional):</label><br />
        <pre id="soundCodeDisplay">@Model.SoundCodeDisplay</pre>
    </div>
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");} 

    @if (Model.SoundParametersJson != null && Model.SoundParametersJson != "[]")
    {
        <script>
            // Make the sound parameters available to client-side JavaScript
            var soundParametersForPlayback = JSON.parse('@Html.Raw(Model.SoundParametersJson)');
            
            // You can now log this to the console to verify in the browser
            console.log("Sound parameters for playback:", soundParametersForPlayback);

            // Later, you will pass soundParametersForPlayback to your audio synthesis function
        </script>
    }
}